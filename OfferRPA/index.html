<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>æ‹›è˜è‡ªåŠ¨åŒ–ç³»ç»Ÿç®¡ç†é¢æ¿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* åŸºç¡€æ ·å¼ */
    body {
      margin: 0; font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa; color: #333;
      display: flex; height: 100vh;
    }
    /* ä¾§è¾¹æ  */
    nav {
      width: 220px;
      background: #004a9f;
      color: white;
      display: flex;
      flex-direction: column;
      padding-top: 20px;
    }
    nav h2 {
      margin: 0 0 20px 20px;
      font-weight: 700;
      font-size: 1.4rem;
    }
    nav button {
      background: none;
      border: none;
      color: white;
      padding: 15px 20px;
      text-align: left;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s ease;
      border-left: 4px solid transparent;
    }
    nav button:hover, nav button.active {
      background: #0063d1;
      border-left: 4px solid #ffcc00;
      font-weight: 700;
    }
    /* å†…å®¹åŒºåŸŸ */
    main {
      flex-grow: 1;
      padding: 30px;
      overflow-y: auto;
    }
    main h1 {
      margin-top: 0;
      color: #004a9f;
    }
    section.module {
      display: none;
    }
    section.module.active {
      display: block;
    }
    /* å…¬å…±è¡¨å•æ ·å¼ */
    label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
    }
    input, select, textarea, button {
      margin-top: 6px;
      padding: 8px 12px;
      width: 100%;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button.primary {
      background-color: #0078d4;
      border: none;
      color: white;
      margin-top: 20px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button.primary:hover {
      background-color: #005ea2;
    }

    /* æ—¥å¿—åŒºåŸŸ */

    #log {
  margin-top: 40px;
  background: #eaeef6;
  border-radius: 6px;
  padding: 10px 15px 5px 15px; /* ä¸Šä¸‹å†…è¾¹è·è°ƒæ•´ï¼Œä¸Šé¢ç¨å°ï¼Œä¸‹é¢æ›´å° */
  max-height: 180px;
  overflow-y: hidden;  /* å…³é—­æ»šåŠ¨æ¡ */
  font-size: 0.9rem;
  color: #555;
  white-space: pre-wrap;
  line-height: 1.4;     /* å¯ä»¥è°ƒæ•´è¡Œé«˜ï¼Œæ–‡å­—æ›´ç´§å‡‘ */
}


        button.secondary {
  background-color: #e2e8f0;     /* ç¨æ·±çš„ç°è“ï¼Œè§†è§‰ä¸Šæœ‰â€œé‡é‡â€ */
  border: 1px solid #cbd5e0;     /* å’ŒèƒŒæ™¯æ¥è¿‘çš„è¾¹æ¡†ï¼ŒæŸ”å’Œä¸çªå…€ */
  color: #2a4365;                /* ç¨æ·±çš„è“ç°è‰²æ–‡å­—ï¼Œæ¸…æ™°ä½†ä¸åˆºçœ¼ */
  cursor: pointer;
  transition: background-color 0.3s ease, border-color 0.3s ease;
}

button.secondary:hover {
  background-color: #cbd5e0;     /* é¼ æ ‡æ‚¬åœæ—¶ï¼Œç¨å¾®å†æ·±ä¸€ç‚¹ */
  border-color: #a0aec0;
}



  </style>
</head>
<body> 

  <nav> 
    <h2>æ‹›è˜è‡ªåŠ¨åŒ–ç³»ç»Ÿ</h2>

    <button data-target="candidate-profile">å€™é€‰äººç®¡ç†</button>
    <button data-target="job-management">å²—ä½ç®¡ç†</button>
    <button data-target="interview-schedule">é¢è¯•å®‰æ’</button>
    <button data-target="ai-screening">AIç®€å†ç­›é€‰</button>
    <button data-target="statistics">ç»Ÿè®¡åˆ†æ</button> 
      <button data-target="candidate-database">ğŸ“š äººæ‰èµ„æ–™åº“</button> <!-- âœ… åŠ è¿™é‡Œ --> 
  </nav>
  <main>
<section id="candidate-profile" class="module">
  <h1>å€™é€‰äººèµ„æ–™ç®¡ç†</h1> 
  
  <!-- é‚®ç®±è¾“å…¥ï¼šå¿…å¡«ï¼Œç”¨äºèº«ä»½ç¡®è®¤ -->
<label for="candidateEmail">å€™é€‰äººé‚®ç®±ï¼ˆå¿…å¡«ï¼‰</label>
<input type="email" id="candidateEmail" placeholder="è¾“å…¥å€™é€‰äººé‚®ç®±" required />

<label for="resume">ä¸Šä¼ ç®€å†ï¼ˆå¯é€‰ï¼‰</label>
<textarea id="resume" rows="6" placeholder="è¾“å…¥ç®€å†æ–‡æœ¬æˆ–å¤‡æ³¨"></textarea> 

<!-- ä¸¤ä¸ªåˆ†å¼€çš„æŒ‰é’® -->
<button class="primary" id="verifyEmail">ğŸ“© éªŒè¯é‚®ç®±</button>
<button class="secondary" id="saveCandidate">ğŸ’¾ ä¿å­˜èµ„æ–™</button>

<div id="candidateStatus" style="margin-top:12px;"></div>  

<!-- æ–°å¢è°ƒç”¨Zapierçš„æŒ‰é’® -->
<button id="callZapier" style="margin-top:10px;">è°ƒç”¨Zapier Webhook</button>

  <div id="candidateStatus" style="margin-top:10px; color:#333;"></div>
  <div id="zapierStatus" style="margin-top:6px; color:#333;"></div> 


</section> 


<section id="job-management" class="module">
  <h1>ğŸ“ æ‹›è˜å²—ä½ç®¡ç†</h1>
  <label for="jobTitle">å²—ä½åç§°</label>
  <input type="text" id="jobTitle" placeholder="è¾“å…¥å²—ä½åç§°" />
  <label for="jobDesc">å²—ä½æè¿°</label>
  <textarea id="jobDesc" rows="5" placeholder="è¾“å…¥å²—ä½æè¿°"></textarea>
  <button class="primary" id="saveJob">ä¿å­˜å²—ä½</button>
  <div id="jobStatus" style="margin-top:12px;"></div>
</section>

<!-- æ–°å¢çš„å‘é€éªŒè¯é‚®ä»¶åŒºå— -->
<section id="email-verification" class="module">
  <h1>ğŸ“§ å‘é€éªŒè¯é‚®ä»¶</h1>
  <label for="email">å€™é€‰äººé‚®ç®±ï¼ˆå‘é€éªŒè¯ç”¨ï¼‰</label>
  <input type="email" id="email" placeholder="è¾“å…¥å€™é€‰äººé‚®ç®±" />

  <label for="jobType">å²—ä½ç±»å‹</label>
  <select id="jobType">
    <option value="æŠ€æœ¯å²—">æŠ€æœ¯å²—</option>
    <option value="äº§å“å²—">äº§å“å²—</option>
    <option value="è¿è¥å²—">è¿è¥å²—</option>
  </select>

  <button class="secondary" id="sendVerification">ğŸ“§ å‘é€éªŒè¯é‚®ä»¶</button>
  <div id="emailStatus" style="margin-top:12px;"></div>
</section>

<section id="interview-schedule" class="module">
  <h1>ğŸ“… é¢è¯•å®‰æ’é€šçŸ¥</h1>
  <label for="interviewCandidate">å€™é€‰äººé‚®ç®±</label>
  <input type="email" id="interviewCandidate" placeholder="è¾“å…¥å€™é€‰äººé‚®ç®±" />
  <label for="interviewTime">é¢è¯•æ—¶é—´</label>
  <input type="datetime-local" id="interviewTime" />
  <button class="primary" id="scheduleInterview">å‘é€é¢è¯•é€šçŸ¥</button>
  <div id="interviewStatus" style="margin-top:12px;"></div>
</section>


<section id="ai-screening" class="module">
  <h1>ğŸ—ƒï¸ AI ç®€å†ç­›é€‰</h1>
  <p>ä¸Šä¼ ç®€å†åç³»ç»Ÿå°†è‡ªåŠ¨è¯†åˆ«å€™é€‰äººä¿¡æ¯ï¼Œæ¨èé€‚é…å²—ä½ï¼Œå¹¶çº³å…¥äººæ‰èµ„æ–™åº“ã€‚</p>

  <label for="aiEmail">å€™é€‰äººé‚®ç®±</label>
  <input type="email" id="aiEmail" placeholder="è¾“å…¥å€™é€‰äººé‚®ç®±" />

  <label for="aiResume">ç®€å†æ–‡æœ¬</label>
  <textarea id="aiResume" rows="8" placeholder="ç²˜è´´ç®€å†æˆ–è‡ªæˆ‘ä»‹ç»"></textarea>

  <button class="primary" id="runAiScreening">å¼€å§‹ç­›é€‰</button>

  <div id="aiStatus" style="margin-top:16px; font-weight:500;"></div>
</section>

<section id="statistics" class="module">
  <h1>ğŸ“Š ç»Ÿè®¡åˆ†æ</h1>
  <p>ç³»ç»Ÿå…³é”®æ•°æ®ç»Ÿè®¡æŠ¥è¡¨å±•ç¤ºåŒºåŸŸï¼ŒåŒ…å«è½¬åŒ–ç‡ã€éªŒè¯ç‡ã€æ¨èç‚¹å‡»ç‡ç­‰ã€‚ï¼ˆæ•°æ®ä»…ä¸ºç¤ºä¾‹ï¼‰</p>
  <button class="primary" id="refreshStats">åˆ·æ–°ç»Ÿè®¡æ•°æ®</button>
  <pre id="statsData" style="background:#eef2f7; padding:10px; border-radius:6px; margin-top:12px; min-height:150px; white-space:pre-wrap;">
æš‚æ— æ•°æ®
  </pre>
</section>


    <section id="candidate-database" class="module">
  <h1>ğŸ“š äººæ‰èµ„æ–™åº“</h1>
  <table style="width:100%; border-collapse:collapse; margin-top:10px; border:1px solid #ccc;">
    <thead style="background:#f0f3f8;">
      <tr>
        <th style="padding:10px; border-bottom:1px solid #ccc;">é‚®ç®±</th>
        <th style="padding:10px; border-bottom:1px solid #ccc;">å²—ä½æ„å‘</th>
        <th style="padding:10px; border-bottom:1px solid #ccc;">ç®€å†æ¦‚è§ˆ</th>
        <th style="padding:10px; border-bottom:1px solid #ccc;">éªŒè¯çŠ¶æ€</th>
        <th style="padding:10px; border-bottom:1px solid #ccc;">é¢è¯•æ—¶é—´</th>
        <th style="padding:10px; border-bottom:1px solid #ccc;">æ¨èå²—ä½</th>
      </tr>
    </thead>
    <tbody id="candidateTable">
      <tr>
        <td colspan="6" style="text-align:center; color:#888; padding:20px;">
          æš‚æ— å€™é€‰äººæ•°æ®
        </td>
      </tr>
    </tbody>
  </table>
</section> 

<!-- åœ¨ </main> å‰ æˆ–åˆé€‚ä½ç½® æ·»åŠ æ—¥å¿—é¢æ¿ -->
<div id="log" style="margin-top: 30px;">
  <h2>ğŸ§¾ æ“ä½œæ—¥å¿—</h2>
  <pre id="logContent">æš‚æ— æ“ä½œæ—¥å¿—</pre>
</div> 


</main>


  <script> 
document.getElementById('statistics').classList.add('active');
const candidateDB = [];

const buttons = document.querySelectorAll('nav button');
const modules = document.querySelectorAll('section.module');
const logContent = document.getElementById('logContent');

// æ¨¡å—åˆ‡æ¢
buttons.forEach(btn => {
  btn.addEventListener('click', () => {
    buttons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    const target = btn.dataset.target;
    modules.forEach(mod => {
      mod.classList.toggle('active', mod.id === target);
    });

    if (target === 'candidate-database') {
      renderCandidateTable();
    }
  });
});

function appendLog(text) {
  const time = new Date().toLocaleTimeString();
  if (logContent.textContent === "æš‚æ— æ“ä½œæ—¥å¿—") logContent.textContent = "";
  logContent.textContent += `[${time}] ${text}\n`;
  logContent.scrollTop = logContent.scrollHeight;
}

function renderCandidateTable() {
  const tableBody = document.getElementById('candidateTable');

  if (candidateDB.length === 0) {
    tableBody.innerHTML = `
      <tr>
        <td colspan="6" style="text-align:center; color:#888; padding:20px;">
          æš‚æ— å€™é€‰äººæ•°æ®
        </td>
      </tr>`;
    return;
  }

  let html = "";
  candidateDB.forEach(c => {
    html += `<tr>
      <td>${c.email}</td>
      <td>${c.jobIntent}</td>
      <td>${c.resume.length > 20 ? c.resume.slice(0, 20) + "..." : c.resume}</td>
      <td>${c.verified ? "âœ… å·²éªŒè¯" : "âŒ æœªéªŒè¯"}</td>
      <td>${c.interview}</td>
      <td>${c.aiRecommend}</td>
    </tr>`;
  });
  tableBody.innerHTML = html;
}

// ç»Ÿä¸€è°ƒç”¨åç«¯æ¥å£å‡½æ•°
async function callBackend(data) {
  const url = 'https://my-netlify-hof.netlify.app/.netlify/functions/partner-connect'; // æ›¿æ¢æˆä½ çš„åç«¯æ¥å£URL
  try {
    const res = await fetch(url, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data),
      mode: 'cors'
    });
    const json = await res.json();
    if (!res.ok) {
      throw new Error(json.error || 'æœåŠ¡å™¨è¿”å›é”™è¯¯');
    }
    return json;
  } catch (error) {
    throw error;
  }
}

// å‘é€éªŒè¯é‚®ä»¶
document.getElementById('sendVerification').addEventListener('click', async () => {
  const email = document.getElementById('email').value.trim();
  const jobType = document.getElementById('jobType').value;
  const statusEl = document.getElementById('emailStatus');

  if (!email) {
    statusEl.textContent = "è¯·å¡«å†™æœ‰æ•ˆçš„å€™é€‰äººé‚®ç®±ã€‚";
    statusEl.style.color = 'red';
    return;
  }

  statusEl.textContent = "å‘é€ä¸­...";
  statusEl.style.color = 'black';

  try {
    await callBackend({
      email,
      jobType,
      action: 'sendEmail'
    });
    statusEl.textContent = `âœ… éªŒè¯é‚®ä»¶å·²å‘é€è‡³ ${email}`;
    statusEl.style.color = 'green';
    appendLog(`å‘é€éªŒè¯é‚®ä»¶ç»™ ${email}ï¼ˆå²—ä½ç±»å‹ï¼š${jobType}ï¼‰`);
  } catch (err) {
    statusEl.textContent = err.message;
    statusEl.style.color = 'red';
  }
});

// AIç®€å†ç­›é€‰
document.getElementById('runAiScreening').addEventListener('click', async () => {
  const email = document.getElementById('aiEmail').value.trim();
  const resume = document.getElementById('aiResume').value.trim();
  const statusEl = document.getElementById('aiStatus');

  if (!email || !resume) {
    statusEl.textContent = "è¯·å¡«å†™å€™é€‰äººé‚®ç®±å’Œç®€å†æ–‡æœ¬ã€‚";
    statusEl.style.color = 'red';
    return;
  }

  statusEl.textContent = "æ­£åœ¨åˆ†æç®€å†å¹¶åŒ¹é…å²—ä½ï¼Œè¯·ç¨å€™...";
  statusEl.style.color = 'black';

  try {
    const data = await callBackend({
      email,
      resume,
      action: 'aiScreen'
    });

    const recommendedJob = data.recommendedJob || "äº§å“ç»ç† / è§£å†³æ–¹æ¡ˆæ¶æ„å¸ˆï¼ˆæ™ºèƒ½æ¨èï¼‰";

    // æ›´æ–°æœ¬åœ°ç¼“å­˜
    candidateDB.push({
      email,
      jobIntent: "AIæ¨è",
      resume,
      verified: true,
      interview: "-",
      aiRecommend: recommendedJob
    });

    statusEl.innerHTML = `
      âœ… ç­›é€‰å®Œæˆï¼Œæ¨èå²—ä½ï¼š<strong>${recommendedJob}</strong><br />
      å·²å°†å€™é€‰äººä¿¡æ¯çº³å…¥äººæ‰èµ„æ–™åº“ã€‚
    `;
    statusEl.style.color = 'green';
    appendLog(`AIç­›é€‰å®Œæˆï¼š${email} â†’ æ¨èã€${recommendedJob}ã€‘`);
    renderCandidateTable();
  } catch (err) {
    statusEl.textContent = err.message;
    statusEl.style.color = 'red';
  }
});

// ä¿å­˜å²—ä½
document.getElementById('saveJob').addEventListener('click', async () => {
  const title = document.getElementById('jobTitle').value.trim();
  const desc = document.getElementById('jobDesc').value.trim();
  const statusEl = document.getElementById('jobStatus');

  if (!title) {
    statusEl.textContent = "è¯·å¡«å†™å²—ä½åç§°ã€‚";
    statusEl.style.color = 'red';
    return;
  }

  statusEl.textContent = "ä¿å­˜ä¸­...";
  statusEl.style.color = 'black';

  try {
    await callBackend({
      jobTitle: title,
      jobDesc: desc,
      action: 'saveJob'
    });
    statusEl.textContent = `âœ… å²—ä½ã€${title}ã€‘ä¿¡æ¯å·²ä¿å­˜ã€‚`;
    statusEl.style.color = 'green';
    appendLog(`ä¿å­˜å²—ä½ä¿¡æ¯ï¼š${title}`);
  } catch (err) {
    statusEl.textContent = err.message;
    statusEl.style.color = 'red';
  }
});

// é¢è¯•é€šçŸ¥
document.getElementById('scheduleInterview').addEventListener('click', async () => {
  const email = document.getElementById('interviewCandidate').value.trim();
  const time = document.getElementById('interviewTime').value;
  const statusEl = document.getElementById('interviewStatus');

  if (!email || !time) {
    statusEl.textContent = "è¯·å¡«å†™å€™é€‰äººé‚®ç®±å’Œé¢è¯•æ—¶é—´ã€‚";
    statusEl.style.color = 'red';
    return;
  }

  statusEl.textContent = "å‘é€ä¸­...";
  statusEl.style.color = 'black';

  try {
    await callBackend({
      email,
      interviewTime: time,
      action: 'scheduleInterview'
    });

    statusEl.textContent = `âœ… é¢è¯•é€šçŸ¥å·²å‘é€ç»™ ${email}ï¼Œæ—¶é—´ï¼š${new Date(time).toLocaleString()}`;
    statusEl.style.color = 'green';
    appendLog(`é¢è¯•é€šçŸ¥ï¼š${email} æ—¶é—´ ${new Date(time).toLocaleString()}`);

    // æ›´æ–°æœ¬åœ°æ•°æ®
    const candidate = candidateDB.find(c => c.email === email);
    if (candidate) {
      candidate.interview = new Date(time).toLocaleString();
      renderCandidateTable();
    }
  } catch (err) {
    statusEl.textContent = err.message;
    statusEl.style.color = 'red';
  }
});

// ç»Ÿè®¡æ•°æ®åˆ·æ–°ï¼ˆç¤ºä¾‹æœ¬åœ°æ•°æ®ï¼Œæ²¡è°ƒç”¨æ¥å£ï¼‰
document.getElementById('refreshStats').addEventListener('click', () => {
  document.querySelectorAll('section.module').forEach(mod => {
    mod.classList.remove('active');
  });
  document.getElementById('statistics').classList.add('active');

  const statsEl = document.getElementById('statsData');
  statsEl.textContent = "åŠ è½½ä¸­...";
  statsEl.style.color = 'black';

  setTimeout(() => {
    const exampleStats = {
      "éªŒè¯é‚®ä»¶å‘é€æ•°": 1200,
      "é‚®ç®±éªŒè¯é€šè¿‡ç‡": "87%",
      "æœ‰æ•ˆå€™é€‰äººæ•°": 1044,
      "é¢è¯•é¢„çº¦æ•°": 350,
      "é¢è¯•å‡ºå¸­ç‡": "92%",
      "AIå²—ä½æ¨èç‚¹å‡»æ•°": 280,
      "å¹³å‡å“åº”æ—¶é—´": "1.2 å¤©",
      "å²—ä½è½¬åŒ–ç‡": "29%",
      "å€™é€‰äººæµå¤±ç‡": "13%",
      "å¹³å‡é¢è¯•åé¦ˆæ—¶é•¿": "2.5 å¤©"
    };

    let html = "<ul style='padding-left:20px; line-height:1.6;'>";
    for (const [key, value] of Object.entries(exampleStats)) {
      html += `<li><strong>${key}ï¼š</strong>${value}</li>`;
    }
    html += "</ul>";

    statsEl.innerHTML = html;
    appendLog("åˆ·æ–°ç»Ÿè®¡æ•°æ®");
  }, 1000);
});

// ä¿å­˜å€™é€‰äººä¿¡æ¯ï¼ˆæ‰‹åŠ¨æ·»åŠ ï¼‰
document.getElementById('saveCandidate').addEventListener('click', async () => {
  const email = document.getElementById('candidateEmail').value.trim();
  const resume = document.getElementById('resume').value.trim();
  const statusEl = document.getElementById('candidateStatus');

  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  if (!email) {
    statusEl.textContent = "è¯·å¡«å†™å€™é€‰äººé‚®ç®±ã€‚";
    statusEl.style.color = 'red';
    return;
  }
  if (!emailRegex.test(email)) {
    statusEl.textContent = "è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€ã€‚";
    statusEl.style.color = 'red';
    return;
  }

  // æœ¬åœ°åˆ¤æ–­æ˜¯å¦é‡å¤
  const exists = candidateDB.some(c => c.email === email);
  if (exists) {
    statusEl.textContent = `å€™é€‰äººé‚®ç®± ${email} å·²å­˜åœ¨ï¼Œæ— æ³•é‡å¤æ·»åŠ ã€‚`;
    statusEl.style.color = 'red';
    return;
  }

  // è¿™é‡Œè°ƒç”¨æ¥å£ä¿å­˜å€™é€‰äººèµ„æ–™
  statusEl.textContent = "ä¿å­˜ä¸­...";
  statusEl.style.color = 'black';

  try {
    await callBackend({
      email,
      resume,
      action: 'saveCandidate'
    });

    // æœ¬åœ°æ›´æ–°ç¼“å­˜
    candidateDB.push({
      email,
      jobIntent: "æ‰‹åŠ¨æ·»åŠ ",
      resume,
      verified: false,
      interview: "-",
      aiRecommend: "-"
    });

    statusEl.innerHTML = `âœ… å€™é€‰äºº <strong>${email}</strong> å·²ä¿å­˜åˆ°äººæ‰èµ„æ–™åº“ã€‚`;
    statusEl.style.color = 'green';
    appendLog(`æ‰‹åŠ¨æ·»åŠ å€™é€‰äººï¼š${email}`);
    renderCandidateTable();
  } catch (err) {
    statusEl.textContent = err.message;
    statusEl.style.color = 'red';
  }
});



// éªŒè¯é‚®ç®±æŒ‰é’®ï¼ˆåŸºäº #candidate-profile åŒºåŸŸï¼‰
const verifyBtn = document.getElementById('verifyEmail');
const verifyStatus = document.getElementById('candidateStatus');
let isVerifying = false;

verifyBtn.addEventListener('click', async () => {
  if (isVerifying) return;

  const emailInput = document.getElementById('candidateEmail');
  const email = emailInput.value.trim();
  const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  verifyStatus.classList.remove('error');
  verifyStatus.textContent = "";

  if (!email || !emailPattern.test(email)) {
    verifyStatus.textContent = 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€';
    verifyStatus.classList.add('error');
    verifyStatus.style.color = 'red';
    return;
  }

  isVerifying = true;
  verifyStatus.textContent = "å‘é€éªŒè¯é‚®ä»¶ä¸­ï¼Œè¯·ç¨å€™...";
  verifyStatus.style.color = 'black';

  try {
    const data = await callBackend({
      email,
      name: "",  // å¦‚æœæœ‰å§“åå­—æ®µï¼Œå¯å¡«
      userType: "candidate",
      action: 'verifyEmail'
    });

    verifyStatus.textContent = 'âœ… éªŒè¯é‚®ä»¶å·²å‘é€ï¼Œè¯·æŸ¥æ”¶æ‚¨çš„é‚®ç®±ã€‚';
    verifyStatus.classList.remove('error');
    verifyStatus.style.color = 'green';
    appendLog(`å‘é€éªŒè¯é‚®ä»¶ç»™ ${email}`);
  } catch (err) {
    verifyStatus.textContent = err.message || 'å‘é€å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚';
    verifyStatus.classList.add('error');
    verifyStatus.style.color = 'red';
  } finally {
    isVerifying = false;
  }
});


// è°ƒç”¨ Zapier Webhook
document.getElementById('callZapier').addEventListener('click', async () => {
  const zapierStatus = document.getElementById('zapierStatus');

  const email = document.getElementById('candidateEmail')?.value.trim() || "";
  const jobTitle = document.getElementById('jobTitle')?.value.trim() || "";

  if (!email) {
    zapierStatus.textContent = "è¯·å…ˆå¡«å†™å€™é€‰äººé‚®ç®±ã€‚";
    zapierStatus.style.color = 'red';
    return;
  }

 if (!jobTitle) {
  appendLog("âš ï¸ æœªå¡«å†™å²—ä½åç§°ï¼Œç»§ç»­è°ƒç”¨ Zapier Webhook"); 
}


  zapierStatus.textContent = "æ­£åœ¨è°ƒç”¨Zapier Webhookï¼Œè¯·ç¨å€™...";
  zapierStatus.style.color = 'black';

  try {
    // è¿™é‡Œä½ ä¹Ÿå¯ä»¥ç”¨åç«¯æ¥å£è°ƒç”¨Zapierï¼Œè¿™é‡Œç›´æ¥ç”¨fetchè°ƒç”¨Zapier URL
    const webhookUrl = 'https://hooks.zapier.com/hooks/catch/24035737/u62a3uo/'; // æ›¿æ¢ä¸ºä½ çš„Zapier Webhookåœ°å€

    const response = await fetch(webhookUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        email,
        jobTitle,
        timestamp: new Date().toISOString()
      })
    });

    if (response.ok) {
      zapierStatus.textContent = "âœ… æˆåŠŸè°ƒç”¨Zapier Webhookã€‚";
      zapierStatus.style.color = 'green';
      appendLog(`è°ƒç”¨Zapier Webhookï¼šemail=${email}, jobTitle=${jobTitle}`);
    } else {
      zapierStatus.textContent = `è°ƒç”¨å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š${response.status}`;
      zapierStatus.style.color = 'red';
    }
  } catch (error) {
    zapierStatus.textContent = "è°ƒç”¨Zapieræ—¶å‘ç”Ÿç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚";
    zapierStatus.style.color = 'red';
    console.error('Zapierè°ƒç”¨é”™è¯¯:', error);
  }
});

</script>

</body>



</html> 